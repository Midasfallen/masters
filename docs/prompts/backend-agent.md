# Backend Agent - Шаблон промпта

## Использование

Скопируйте этот шаблон и заполните параметры для делегирования задачи Backend Agent.

---

## Шаблон

```
[Backend Agent] [Название задачи]:

КОНТЕКСТ (обязательно):
- Связанные файлы: 
  - [путь к файлу 1]
  - [путь к файлу 2]
- Похожие паттерны: 
  - Используй паттерн из [путь к похожему модулю]
  - Пример: backend/src/modules/posts/
- Документация:
  - [ссылка на docs если есть]
- Зависимости:
  - [список зависимостей]

ТРЕБОВАНИЯ:
1. [требование 1 - конкретное и измеримое]
2. [требование 2]
3. [требование 3]

ОЖИДАЕМЫЙ РЕЗУЛЬТАТ:
- [что должно получиться]
- [структура файлов]
- [API endpoints если применимо]

КРИТЕРИИ ВАЛИДАЦИИ:
- Запусти type-check: npm run build
- Проверь соответствие стандартам проекта
- Убедись, что Swagger документация добавлена
- Проверь валидацию через class-validator

ОГРАНИЧЕНИЯ:
- Не используй `any` в TypeScript
- Всегда используй транзакции для связанных операций
- Проверяй существование записей перед обновлением
- Используй snake_case для БД/API, camelCase для кода
```

---

## Примеры использования

### Пример 1: Создание нового модуля

```
[Backend Agent] Создай модуль Notifications:

КОНТЕКСТ:
- Связанные файлы:
  - backend/src/modules/posts/posts.module.ts
  - backend/src/modules/posts/posts.controller.ts
  - backend/src/modules/posts/posts.service.ts
- Похожие паттерны:
  - Используй структуру из backend/src/modules/posts/
- Документация:
  - docs/api/API-v2-Summary.md
- Зависимости:
  - Связь с users через user_id (UUID)
  - Связь с posts через post_id (опционально)

ТРЕБОВАНИЯ:
1. Создай notifications.module.ts с импортом TypeOrmModule
2. Создай notifications.controller.ts с CRUD endpoints
3. Создай notifications.service.ts с бизнес-логикой
4. Создай dto/create-notification.dto.ts с валидацией
5. Создай entities/notification.entity.ts с TypeORM декораторами

ОЖИДАЕМЫЙ РЕЗУЛЬТАТ:
- Модуль готов к использованию
- Swagger документация для всех endpoints
- Валидация всех входных данных
- Правильные связи с users и posts

КРИТЕРИИ ВАЛИДАЦИИ:
- npm run build проходит без ошибок
- Соответствие стандартам проекта
- Swagger UI показывает все endpoints
- Валидация работает корректно

ОГРАНИЧЕНИЯ:
- Не используй `any`
- Используй транзакции для создания уведомлений
- Проверяй существование user_id перед созданием
```

---

### Пример 2: Исправление бага

```
[Backend Agent] Исправь баг с валидацией email:

КОНТЕКСТ:
- Связанные файлы:
  - backend/src/modules/users/dto/create-user.dto.ts
  - backend/src/modules/auth/dto/login.dto.ts
- Ошибка:
  - Email "test@test" проходит валидацию, но должен отклоняться
  - Логи: "Invalid email format" не срабатывает
- Недавние изменения:
  - Последний коммит: "feat: добавлена валидация email"

ТРЕБОВАНИЯ:
1. Исправь валидацию email во всех DTO
2. Используй @IsEmail() декоратор с опциями
3. Добавь кастомное сообщение об ошибке

ОЖИДАЕМЫЙ РЕЗУЛЬТАТ:
- Email "test@test" отклоняется с понятным сообщением
- Все существующие тесты проходят
- Валидация работает во всех DTO

КРИТЕРИИ ВАЛИДАЦИИ:
- npm test проходит
- Ручная проверка: "test@test" отклоняется
- Все существующие тесты проходят

ОГРАНИЧЕНИЯ:
- Не ломай существующую функциональность
- Сохрани обратную совместимость
```

---

## Специализация Backend Agent

**Экспертиза:**
- ✅ NestJS (контроллеры, сервисы, модули, guards, interceptors)
- ✅ TypeORM (entities, repositories, migrations, queries)
- ✅ Валидация (class-validator, class-transformer)
- ✅ Swagger документация
- ✅ PostgreSQL и PostGIS
- ✅ Транзакции и оптимизация запросов

**Когда использовать:**
- Создание новых API endpoints
- Рефакторинг backend логики
- Работа с базой данных
- Миграции и seeds
- Исправление багов в Backend
